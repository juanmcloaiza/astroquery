.. _astroquery.eso:

******************************
ESO Queries (`astroquery.eso`)
******************************

.. warning::

    **⚠️ Backward Compatibility Notice ⚠️**

    **The WDB (Web DataBase) API is being deprecated and replaced by TAP (Table Access Protocol)**,
    a standardized interface for querying astronomical datasets using ADQL (Astronomical Data Query Language).
    While the Python interface remains the same, the values accepted by the ``columns`` and ``column_filters``
    parameters must reflect TAP field names and ADQL syntax. This means that,
    although the structure of your code won't need to change, **the values you pass to the arguments**
    ``columns`` **and** ``column_filters`` **must be revised** to comply with the new format.

    In TAP, ``column_filters`` accepts ADQL expressions. For example:

    .. doctest-skip::

        column_filters = {
            'some_int_column': "< 5",
            'some_float_column_2': ">= 1.23",
            'some_char_column': "like '%John%'",
            'some_generic_column': "in ('mango', 'apple', 'kiwi')",
            'other_generic_column': "between '2024-01-01' and '2024-12-31'"
        }

    Please review your queries carefully and update them accordingly to ensure compatibility with the new astroquery versions.
    See section :ref:`column-filters-fix` at the end of this document. 

Introduction
============

Overview of the ESO Archive
---------------------------

The `ESO Science Archive Facility (SAF) <https://archive.eso.org>`_ is one of the largest ground-based astronomical data repositories in the world. It contains, and provides access to, data from ESO telescopes at the `La Silla <https://www.eso.org/public/teles-instr/lasilla/>`_, `Paranal <https://www.eso.org/public/teles-instr/paranal/>`_, and `APEX <https://www.eso.org/public/teles-instr/apex/>`_ observatories, as well as the submillimeter APEX telescope on Llano de Chajnantor and the `ALMA <https://www.eso.org/public/teles-instr/alma/>`_ array. The archive includes all raw data from La Silla Paranal Observatory, corresponding calibrations, and a wide range of processed data products, either generated by ESO or contributed by the community. It also hosts selected external datasets, such as raw WFCAM/UKIDSS data from the UKIRT facility in Hawaii. As of May 2025, the archive hosts over `4.6 million science products <https://archive.eso.org/scienceportal/home>`_, including:

- `>3.8 million products from La Silla, Paranal, and APEX <https://archive.eso.org/scienceportal/home?observatory=%22La%20Silla%20Paranal%20APEX%22>`_
- `>700,000 ALMA products <https://archive.eso.org/scienceportal/home?observatory=ALMA>`_
- `~2.3 million spectra <https://archive.eso.org/scienceportal/home?dp_type=SPECTRUM>`_ (1D extracted, fully calibrated)
- `>900,000 imaging products <https://archive.eso.org/scienceportal/home?dp_type=IMAGE>`_ in optical, near-IR, and sub-mm bands
- `>500,000 spectral cubes <https://archive.eso.org/scienceportal/home?dp_type=CUBE>`_ from IFU and radio/mm instruments
- `~700,000 catalog tiles <https://archive.eso.org/scienceportal/home?dp_type=CATALOG>`_ 

Processed data downloaded from the ESO Archive are assigned a **Digital Object Identifier (DOI)**. The list of available DOIs can be browsed in the `ESO DOI query page <https://archive.eso.org/wdb/wdb/doi/collections/query>`_.

Ways to Access the Archive
--------------------------

Access to data follows ESO’s standard data policy: the **Principal Investigator (PI)** of an observing program has exclusive access to their data during a proprietary period (typically one year), after which the data become publicly available. See the `ESO Data Access Policy <https://archive.eso.org/cms/eso-data-access-policy.html>`_ and `FAQ <https://archive.eso.org/cms/faq.html?q=proprietary>`_ for more information. Browsing the archive does not require authentication, but login is necessary to access proprietary datasets. Use of ESO archival data should be acknowledged in all publications.

There are multiple ways to access the archive:

- The `Raw Data query form <https://archive.eso.org/eso/eso_archive_main.html>`_ gives access to raw frames and their calibrations
- The `Science Portal <https://archive.eso.org/scienceportal/home>`_ allows browsing and retrieval of processed (Phase 3) data
- The `Catalogue Facility <https://www.eso.org/qi/>`_ enables access to PI-contributed catalogue data
- The `Programmatic and Tools access layer <https://archive.eso.org/programmatic/#TAP>`_ provides direct, scriptable access to raw and processed data, metadata, ambient conditions, and catalogues via Virtual Observatory (VO) protocols

This documentation focuses on the last method: accessing the archive programmatically using the ``astroquery.eso`` module. This Python interface allows users to search for both raw and reduced data, retrieve metadata, and download data products directly using dataset identifiers. Proprietary access is supported via authentication with the `ESO User Portal <https://www.eso.org/UserPortal>`_.

Quick Start
===========

.. doctest-skip::

    >>> from astroquery.eso import Eso                                                      # Import the ESO module
    >>> eso = Eso()                                                                         # Create an instance of the ESO class
    >>> table_raw = eso.query_main("muse", column_filters={"object": "NGC300"})             # Query raw data 
    >>> table_reduced = eso.query_surveys("muse", column_filters={"target_name": "NGC300"}) # Query reduced data
    >>> eso.retrieve_data(table_raw['dp_id'])                                               # Download raw data products
    >>> eso.retrieve_data(table_reduced['dp_id'])                                           # Retrieve reduced data products

By default, the maximum number of results returned by a query is by default set to 1000, but this can be adjusted as needed. To return all results without truncation, set the ``maxrec`` attribute to -1:

.. doctest-skip::

    >>> eso.maxrec = -1 # Return all results

Getting Started
===============

.. toctree::
   :maxdepth: 2

   eso_login
   eso_raw_instrument
   eso_raw_general
   eso_reduced
   eso_tap
   eso_cone_search
   eso_header_info
   eso_download
   eso_troubleshooting

Requirements
============

Along with the main requirements of the ``astroquery`` package, the following packages are required for the use of this module:

* `lxml <https://pypi.org/project/lxml>`_

Reference/API
=============

.. automodapi:: astroquery.eso
    :no-inheritance-diagram: